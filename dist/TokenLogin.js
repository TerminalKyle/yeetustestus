function C(o){window.enmity.plugins.registerPlugin(o)}function k(o,n){return window.enmity.modules.getModule(o,n)}function g(...o){return window.enmity.modules.getByProps(...o)}function T(...o){return window.enmity.modules.getByName(...o)}window.enmity.modules.common;function v(o){return window.enmity.patcher.create(o)}var F="TokenLogin",x="1.0.5",E="Login to Discord using a token.",_="#64D3FF",b=[{name:"kyle",id:"1278523345498800130"}],A={name:F,version:x,description:E,color:_,authors:b};function D(o,n,i){return window.enmity.utilities.findInReactTree(o,n,i)}const l=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const t=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage,window.enmity.modules.common.Toasts,window.enmity.modules.common.Dialog,window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users;const L=window.enmity.modules.common.Navigation;window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme,window.enmity.modules.common.Linking;const B=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;const{components:e}=window.enmity;e.Alert,e.Button,e.FlatList,e.Image,e.ImageBackground,e.KeyboardAvoidingView,e.Modal,e.Pressable,e.RefreshControl;const M=e.ScrollView;e.SectionList,e.StatusBar,e.StyleSheet,e.Switch;const y=e.Text;e.TextInput,e.TouchableHighlight,e.TouchableOpacity,e.TouchableWithoutFeedback,e.Touchable;const d=e.View;e.VirtualizedList,e.Form,e.FormArrow,e.FormCTA,e.FormCTAButton,e.FormCardSection,e.FormCheckbox,e.FormDivider,e.FormHint,e.FormIcon;const P=e.FormInput;e.FormLabel,e.FormRadio,e.FormRow,e.FormSection,e.FormSelect,e.FormSubLabel,e.FormSwitch,e.FormTernaryCheckBox,e.FormText,e.FormTextColors,e.FormTextSizes;function r(o){return window.enmity.assets.getIDByName(o)}const R=g("loginToken"),{default:h}=k(o=>o==null?void 0:o.ButtonColors),I=o=>o.id?{id:o.id,username:o.username,discriminator:o.discriminator,avatar:o.avatar,...o.email&&{email:o.email},...o.phone&&{phone:o.phone}}:{};async function N(o){const n=await(await fetch("https://discord.com/api/v9/users/@me",{headers:{authorization:o}})).json();return I(n)}r("add_white"),r("Check"),r("ic_highlight"),r("ic_full_server_gating_24px"),r("ic_my_account_24px"),r("img_nitro_server_avatar"),r("settings"),r("ic_trash_filled_16px"),r("ic_sort"),g("openLazy","hideActionSheet"),g("hex2int"),T("CustomColorPickerActionSheet");function z(o,n){return window.enmity.settings.connectComponent(o,n)}const{createThemedStyleSheet:U}=B;function V({settings:o,onLoginSuccess:n}){const[i,p]=t.useState(""),[m,s]=t.useState(!1),[c,u]=t.useState(""),a=U({container:{flex:1,backgroundColor:l.ThemeColorMap.BACKGROUND_MOBILE_PRIMARY,padding:20,justifyContent:"center"},title:{fontSize:28,fontWeight:"bold",color:l.ThemeColorMap.HEADER_PRIMARY,textAlign:"center",marginBottom:8},subtitle:{fontSize:16,color:l.ThemeColorMap.TEXT_MUTED,textAlign:"center",marginBottom:32},inputContainer:{marginBottom:20},errorText:{color:l.ThemeColorMap.STATUS_DANGER,fontSize:14,textAlign:"center",marginTop:8},infoText:{color:l.ThemeColorMap.TEXT_MUTED,fontSize:14,textAlign:"center",marginTop:16,lineHeight:20},buttonContainer:{marginTop:20}}),f=async()=>{if(!i.trim()){u("Please enter a Discord token");return}s(!0),u("");try{const w=await N(i);if(!w.id){u("Invalid token. Please check your token and try again."),s(!1);return}o.set("saved_token",i),o.set("user_info",w),R.loginToken(i),n()}catch(w){u("Failed to validate token. Please check your token and try again."),console.error("Token validation error:",w)}finally{s(!1)}};return t.createElement(M,{style:a.container,contentContainerStyle:{flexGrow:1,justifyContent:"center"}},t.createElement(d,null,t.createElement(y,{style:a.title},"Discord Token Login"),t.createElement(y,{style:a.subtitle},"Enter your Discord token to continue"),t.createElement(d,{style:a.inputContainer},t.createElement(P,{value:i,onChange:p,title:"Discord Token",placeholder:"Enter your Discord token here...",secureTextEntry:!0,autoCapitalize:"none",autoCorrect:!1}),c?t.createElement(y,{style:a.errorText},c):null),t.createElement(d,{style:a.buttonContainer},t.createElement(h,{onPress:f,text:m?"Logging in...":"Login",style:{backgroundColor:m?"#666":"#5865F2",opacity:m?.7:1},disabled:m})),t.createElement(y,{style:a.infoText},"Enter your Discord token to login. You will need to re-enter it each time Discord starts.")))}var H=z(V,"token-login");T("Welcome",{default:!1});const S=v("account-switcher"),W={...A,onStart(){const o=S.before(d,"render",(n,[i],p)=>{const m=D(i,s=>{var c;return((c=s==null?void 0:s.type)==null?void 0:c.name)==="Welcome"});!m||(m.type=()=>t.createElement(H,{settings:window.enmity.settings.makeStore("token-login"),onLoginSuccess:()=>window.enmity.native.reload()}),o())})},onStop(){S.unpatchAll()},getSettingsPanel(){const o=window.enmity.settings.makeStore("token-login");return t.createElement(d,{style:{flex:1,padding:20,justifyContent:"center"}},t.createElement(h,{onPress:()=>{o.set("saved_token",""),o.set("user_info",null),window.enmity.native.reload()},text:"Logout & Re-login",style:{backgroundColor:"#f04747",marginBottom:10}}),t.createElement(h,{onPress:()=>L.pop(),text:"Close",style:{backgroundColor:"#5865F2"}}))}};C(W);
